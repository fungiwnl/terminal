@import url("https://cdn.jsdelivr.net/npm/@xz/fonts@1/serve/cascadia-code.min.css");

/* Fix viewport issues */
html {
    height: 100%;
    -webkit-text-size-adjust: 100%;
    text-size-adjust: 100%;
}

body {
    background-color: #1e1e1e;
    padding: 16px;
    border-width: 2px;
    background-clip: content-box, padding-box;
    max-width: 100%;
    max-height: 100vh;
    overflow-x: hidden;
    overflow-y: auto;
    margin: 0;
    -webkit-font-smoothing: antialiased;
    -moz-osx-font-smoothing: grayscale;
}

/* Simplified mobile adjustments - NO scroll interference */
@media screen and (max-width: 768px) {
    body {
        padding: 12px;
        touch-action: manipulation;
        /* Removed fixed positioning and height constraints */
    }
}

/* Portrait orientation lock for mobile */
@media screen and (max-width: 768px) and (orientation: landscape) {
    body::before {
        content: "ðŸ“± Please rotate your device to portrait mode for the best experience";
        position: fixed;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background: #1e1e1e;
        color: #aaa;
        display: flex;
        align-items: center;
        justify-content: center;
        text-align: center;
        font-family: 'Cascadia Code', 'SF Mono', Monaco, 'Consolas', monospace;
        font-size: 18px;
        line-height: 1.5;
        z-index: 9999;
        padding: 20px;
        box-sizing: border-box;
    }
    
    .terminal {
        display: none;
    }
    
    body {
        overflow: hidden;
    }
}

.terminal .terminal-output .format, .cmd .format,
.cmd-prompt, .cmd-prompt div {
    display: inline-block;
}

.terminal h1, .terminal h2, .terminal h3, .terminal h4, .terminal h5, .terminal h6, .terminal pre, .cmd {
    margin: 0;
}

.cmd .cmd-clipboard {
    position: absolute !important;
    left: -16px;
    left: calc(-16px / var(--pixel-density, 1)) !important;
    top: 0 !important;
    width: 16px;
    height: 16px;
    width: calc(16px / var(--pixel-density, 1)) !important;
    height: calc(16px / var(--pixel-density, 1)) !important;
    background: transparent !important;
    border: none !important;
    color: transparent !important;
    outline: none !important;
    padding: 0 !important;
    resize: none !important;
    box-shadow: none !important;
    z-index: 1000 !important;
    overflow: hidden !important;
    white-space: pre !important;
    text-indent: -9999em !important;
    top: calc(var(--cursor-line, 0) * var(--size, 1) * (14px / var(--pixel-density, 1))) !important;
}

.visually-hidden {
    clip: rect(0 0 0 0);
    clip-path: inset(50%);
    height: 1px;
    overflow: hidden;
    position: absolute;
    white-space: nowrap;
    width: 20px;
    top: 0;
    left: 0;
}

.cmd span.cmd-end-line,
.cmd span.cmd-end-line span,
.cmd div.cmd-end-line span[data-text]:last-child,
.cmd div.cmd-end-line span[data-text]:last-child span,
.cmd textarea,
.cmd .cursor + span:empty {
    -webkit-touch-callout: none;
    -webkit-user-select: none;
    -khtml-user-select: none;
    -moz-user-select: none;
    -ms-user-select: none;
    user-select: none;
}

.terminal img, .terminal audio, .terminal object, .terminal canvas {
    cursor: default;
}

.terminal {
    position: relative;
    line-height: initial;
    --base-background: var(--background, #1e1e1e);
    --base-color: var(--color);
    contain: content;
    width: 100%;
    box-sizing: border-box;
}

.terminal-scroller {
    position: relative;
    overflow-y: auto;
    overflow-x: hidden;
    scrollbar-gutter: stable;
    height: 100%;
    box-sizing: border-box;
    /* Simple mobile scrolling - no fancy stuff */
    -webkit-overflow-scrolling: touch;
}

/* Simplified mobile terminal adjustments */
@media screen and (max-width: 768px) {
    .terminal-scroller {
        /* Let it scroll naturally */
        overflow-x: hidden;
        overflow-y: auto;
    }
}

.terminal.terminal-temp {
    visibility: hidden;
}

body.terminal {
    min-height: 100vh;
    height: 100%;
}

body.terminal, body.full-screen-terminal {
    margin: 0;
    height: 100%;
}

body.full-screen-terminal .terminal {
    height: 100%;
}

body.full-screen-terminal {
    height: 100%;
    height: var(--terminal-force-height, 100dvh);
}

.terminal > div.terminal-fill {
    min-height: 100%;
    height: 100%;
}

.terminal > .terminal-pixel {
    position: absolute;
    display: inline;
    left: -2px;
    top: -2px;
    width: 1px;
    height: 1px;
}

.terminal > .terminal-resizer,
.terminal > .terminal-font .terminal-resizer {
    position: absolute !important;
    top: 0 !important;
    right: 0 !important;
    bottom: 0 !important;
    left: 0 !important;
    overflow: hidden !important;
    pointer-events: none !important;
    z-index: -1 !important;
    height: 100% !important;
    border: none !important;
    padding: 0 !important;
    width: 100% !important;
}

.cmd {
    padding: 0;
    position: relative;
    width: 100%;
    z-index: 300;
    touch-action: manipulation;
}

.terminal .cmd, .terminal .cmd div {
    background: transparent !important;
}

.terminal a[tabindex="1000"],
.terminal a[tabindex="1000"]:active,
.terminal a[tabindex="1000"]:focus {
    outline: none;
}

.terminal .inverted, .cmd.cmd.cmd .inverted,
.terminal .terminal-inverted, .cmd.cmd.cmd .cmd-inverted {
    background-color: #aaa !important;
    color: #1e1e1e !important;
}

.terminal .terminal-output > :not(.raw) a[href],
.cmd a[href],
.terminal.external a[href] {
    color: #3377FF;
    color: var(--link-color, #3377FF);
    cursor: pointer;
}

.cmd a[href]:not(.terminal-inverted),
.terminal .terminal-output > :not(.raw) a[href]:not(.terminal-inverted),
.terminal.external a[href]:not(.terminal-inverted) {
    --color: var(--link-color, #3377FF);
    text-shadow: 0 0 calc(var(--glow) * 5px) var(--color, #ccc);
}

.terminal .terminal-output > :not(.raw) a[href].terminal-inverted,
.terminal.external a[href].terminal-inverted {
    background: var(--color, #ccc);
    text-shadow: 0 0 calc(var(--glow) * 5px) var(--background, #1e1e1e);
}

.terminal .terminal-output > :not(.raw) a[href]:hover,
.cmd a[href]:hover,
.terminal.external a[href]:hover {
    background-color: #3377FF;
    background-color: var(--link-color, #3377FF) !important;
    color: #1e1e1e;
    color: var(--base-background, #1e1e1e) !important;
    text-decoration: none;
}

.terminal .terminal-output > :not(.raw) a[href] span,
.cmd a[href] span,
.terminal.external a[href] span {
    color: #3377FF !important;
    --color: var(--link-color, #3377FF);
    color: var(--link-color, #3377FF) !important;
    text-decoration: underline;
}

.terminal .terminal-output > :not(.raw) a[href]:hover span,
.cmd a[href]:hover span,
.terminal.external a[href]:hover span {
    background-color: #3377FF !important;
    background-color: var(--link-color, #3377FF) !important;
    color: #1e1e1e !important;
    color: var(--background, #1e1e1e) !important;
    text-decoration: none;
}

.terminal a[href] {
    transition-property: color, background-color;
    transition-duration: 0.2s;
    transition-timing-function: ease-out;
}

.cmd .cmd-cursor {
    display: inline-block;
}

.cmd .cmd-cursor-line > span,
.cmd .cmd-cursor-line img {
    display: inline-block;
}

.cmd .cmd-cursor.cmd-blink > span[data-text]:not(.emoji):not(.fa):not(.far):not(.fas) span,
.cmd .cmd-cursor.cmd-blink a,
.cmd .cmd-cursor.cmd-blink .fa,
.cmd .cmd-cursor.cmd-blink .far,
.cmd .cmd-cursor.cmd-blink .fas,
.cmd .cmd-cursor .emoji {
    -webkit-animation: terminal-blink 1s infinite linear;
    -moz-animation: terminal-blink 1s infinite linear;
    -ms-animation: terminal-blink 1s infinite linear;
    animation: terminal-blink 1s infinite linear;
}

.bar.terminal .inverted, .bar.cmd .cmd-inverted {
    box-shadow: -2px 0 0 -1px #aaa;
    box-shadow: -2px 0 0 -1px var(--original-color, #aaa);
}

.terminal, .terminal .terminal-output > div > div, .cmd .cmd-prompt {
    display: block;
    height: auto;
}

/* FIXED: Text wrapping for mobile without breaking scroll */
.terminal .terminal-output > div:not(.raw) div {
    word-wrap: break-word;
    overflow-wrap: break-word;
    clear: both;
    hyphens: none;
    -webkit-hyphens: none;
    -ms-hyphens: none;
}

/* Mobile-specific text handling */
@media screen and (max-width: 768px) {
    .terminal .terminal-output > div:not(.raw) div {
        white-space: pre-wrap;
        word-break: break-word;
        overflow-wrap: anywhere;
    }
}

.cmd .cmd-prompt > span, .cmd .cmd-prompt > a, .cmd .cmd-prompt:empty {
    float: left;
}

.cmd-prompt [data-text] > span {
    white-space: pre;
}

.cmd [data-text] span,
.terminal [data-text] span {
    display: inline-block;
}

.terminal-ouput span[style*="width"] {
    min-height: 14px;
    min-height: calc(var(--size, 1) * (14px / var(--pixel-density, 1)));
}

.terminal .terminal-output > :not(.raw) > div,
.cmd div,
.terminal.external div {
    line-height: 1em;
    line-height: calc((var(--size) * (16px / var(--pixel-density, 1))) + (1px / var(--pixel-density, 1)));
}

/* Mobile line height adjustments */
@media screen and (max-width: 768px) {
    .terminal .terminal-output > :not(.raw) > div,
    .cmd div,
    .terminal.external div {
        line-height: 1.4em;
    }
}

.cmd .cmd-prompt span.fa::before,
.cmd .cmd-prompt span.fab::before,
.cmd .cmd-prompt span.fad::before,
.cmd .cmd-prompt span.fal::before,
.cmd .cmd-prompt span.far::before,
.cmd .cmd-prompt span.fas {
    position: relative;
    top: 2px;
}

.terminal,
.terminal-output > :not(.raw),
.terminal-output > :not(.raw) span:not(.fas):not(.far):not(.fa),
.terminal-output > :not(.raw) a,
.cmd,
.terminal-font-forcer,
.cmd span:not(.fas):not(.far):not(.fa) {
    font-family: 'Cascadia Code', 'SF Mono', Monaco, 'Consolas', monospace;
    font-family: var(--font, 'Cascadia Code', 'SF Mono', Monaco, 'Consolas', monospace);
}

.terminal,
.cmd {
    font-size: 15px;
    font-weight: bold;
}

/* Mobile font size adjustments */
@media screen and (max-width: 768px) {
    .terminal,
    .cmd {
        font-size: 16px;
        font-weight: 500;
    }
}

@media screen and (max-width: 480px) {
    .terminal,
    .cmd {
        font-size: 15px;
    }
}

.terminal-output > div:not(.raw) div::before,
.cmd .cmd-line::before {
    content: '\0200B';
    width: 0;
    display: inline-block;
}

.terminal span[data-text],
.cmd span[data-text] {
    display: inline-block;
}

.terminal, .terminal-output > div:not(.raw) div > span:not(.token):not(.inverted):not(.terminal-inverted):not(.cmd-inverted):not(.terminal-error):not(.emoji),
.cmd span[data-text]:not(.cmd-inverted):not(.token):not(.emoji) {
    color: #aaa;
    background-color: #1e1e1e;
}

.terminal span[data-text] span, .cmd span[data-text] span {
    text-decoration: inherit;
}

.terminal .ansi > div {
    line-height: 13px !important;
    line-height: calc(var(--size, 1) * (13px / var(--pixel-density, 1))) !important;
}

.cmd span.cmd-prompt, .cmd .cmd-prompt span {
    --background: transparent;
}

.terminal-output .emoji, .cmd .emoji {
    height: 12px;
    height: calc(12px / var(--pixel-density, 1));
    background-size: contain;
    background-repeat: no-repeat;
    color: transparent;
    position: relative;
}

.terminal .terminal-output .fa span,
.terminal .terminal-output .fas span,
.terminal .terminal-output .far span,
.cmd .fa span,
.cmd .fas span,
.cmd .far span {
    background: transparent !important;
    color: transparent !important;
    clip: rect(1px,1px,1px,1px);
    position: absolute;
}

.terminal-output .emoji,
.terminal-output .emoji span,
.cmd .emoji, .cmd .emoji span {
    display: inline-block;
    width: 2ch;
}

.terminal, .cmd {
    box-sizing: border-box;
}

.cmd .cmd-cursor span:not(.token):not(.inverted) {
    color: inherit;
    background-color: inherit;
}

.cmd .emoji.emoji.emoji.emoji, .cmd .emoji.emoji.emoji.emoji span {
    color: transparent;
    background-color: transparent;
}

.cmd .cmd-cursor * {
    background-color: transparent;
}

.terminal span[style*="width"] span,
.cmd span[style*="width"] span {
    width: inherit;
}

.cmd div {
    clear: both;
}

.cmd .cmd-prompt + div {
    clear: right;
}

.terminal .terminal-output > div {
    margin-top: -1px;
}

.terminal-output > div.raw > div * {
    overflow-wrap: anywhere;
    word-wrap: anywhere;
}

.terminal .terminal-font {
    position: absolute;
    float: left;
    font-size: inherit;
    line-height: inherit;
    top: -100%;
    left: 0;
    margin-bottom: 1px;
}

.cmd > span:not(.cmd-prompt) {
    float: left;
}

.cmd .cmd-prompt span.cmd-line {
    display: block;
    float: none;
}

.terminal table {
    border-collapse: collapse;
}

.terminal td {
    border: 1px solid #aaa;
}

.cmd span[data-text]:not(.emoji):not(.fa):not(.fas):not(.far) span {
    background-color: inherit;
    color: inherit;
}

.cmd [role="presentation"].cmd-cursor-line {
    position: relative;
    z-index: 100;
    cursor: text;
}

.cmd .cmd-prompt {
    position: relative;
    z-index: 200;
}

.cmd [role="presentation"]:not(.cmd-cursor-line) {
    overflow: hidden;
}

.cmd {
    --original-color: var(--color, #aaa);
    --original-background: var(--background);
}

.cmd a[href] {
    --original-color: var(--link-color, #3377FF);
}

/* Animation keyframes */
@keyframes terminal-blink {
    0%, 50% {
        background-color: #aaa;
        background-color: var(--original-color, #aaa);
        color: #1e1e1e;
        color: var(--original-background, #1e1e1e);
        box-shadow: 0 0 calc(var(--glow) * 3px) var(--color, #aaa);
    }
    50.1%, 100% {
        background-color: inherit;
        color: inherit;
        color: var(--original-color, #aaa);
        box-shadow: none;
    }
}

/* Mobile input handling - simplified */
@media screen and (max-width: 768px) {
    .cmd-editable {
        font-size: 16px; /* Prevent zoom on focus */
    }
    
    /* Hide problematic elements that might cause scroll issues */
    .cmd .cmd-clipboard {
        opacity: 0;
        pointer-events: none;
    }
    
    /* Fix duplicate input issues on mobile */
    .cmd textarea {
        position: absolute !important;
        left: -9999px !important;
        top: -9999px !important;
        opacity: 0 !important;
        pointer-events: none !important;
    }
    
    /* Ensure only one input is active */
    .terminal .cmd .cmd-clipboard:not(:first-of-type) {
        display: none !important;
    }
    
    /* Hide extra cursor elements that might appear */
    .cmd .cmd-cursor-line:not(:last-child) {
        display: none !important;
    }
    
    /* Fix for multiple prompt lines */
    .cmd .cmd-prompt:not(:first-child) {
        display: none !important;
    }
}

/* Selection styles */
.terminal h1::selection,
.terminal h2::selection,
.terminal h3::selection,
.terminal h4::selection,
.terminal h5::selection,
.terminal h6::selection,
.terminal pre::selection,
.terminal td::selection,
.terminal .terminal-output::selection,
.terminal .terminal-output div div::selection,
.terminal .terminal-output div div a::selection,
.terminal .terminal-output span[data-text]::selection,
.terminal .terminal-output span[data-text]:not(.far):not(.fa):not(.fas) span::selection,
.terminal .terminal-output .raw div::selection,
.cmd span[data-text]:not(.far):not(.fa):not(.fas) span::selection {
    background-color: rgba(170, 170, 170, 0.99);
    color: #1e1e1e;
}

.terminal-output .emoji::selection,
.terminal-output .emoji span::selection,
.cmd .emoji span::selection,
.cmd .emoji::selection,
.cmd textarea::selection {
    background-color: transparent !important;
    color: transparent !important;
}

.terminal .terminal-output > :not(.raw) .terminal-error,
.terminal .terminal-output > :not(.raw) .terminal-error * {
    color: red;
    color: var(--error-color, red);
}

/* Simple scrollbar styling */
.terminal-scroller::-webkit-scrollbar {
    width: 6px;
    height: 6px;
    background: var(--background, #1e1e1e);
}

.terminal-scroller::-webkit-scrollbar-thumb {
    background: var(--color, #aaa);
}

.terminal-scroller::-webkit-scrollbar-thumb:hover {
    background: var(--color, #aaa);
}

.terminal-scroller {
    scrollbar-color: #aaa #1e1e1e;
    scrollbar-color: var(--color, #aaa) var(--background, #1e1e1e);
    scrollbar-width: thin;
}

/* Mobile scrollbar improvements */
@media screen and (max-width: 768px) {
    .terminal-scroller::-webkit-scrollbar {
        width: 8px;
        height: 8px;
    }
    
    .terminal-scroller::-webkit-scrollbar-thumb {
        border-radius: 4px;
    }
}

/* Prevent reduced motion issues on mobile */
@media (prefers-reduced-motion: reduce) {
    .cmd .cmd-cursor.cmd-blink > span[data-text]:not(.emoji):not(.fa):not(.far):not(.fas) span,
    .cmd .cmd-cursor.cmd-blink a,
    .cmd .cmd-cursor.cmd-blink .fa,
    .cmd .cmd-cursor.cmd-blink .far,
    .cmd .cmd-cursor.cmd-blink .fas,
    .cmd .cmd-cursor .emoji {
        animation: none;
    }
}
